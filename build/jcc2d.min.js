!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i(t.JC=t.JC||{})}(this,function(t){"use strict";function i(t,i,e,s){this.x=t||0,this.y=i||0,this.z=e||0,this.w=s||0}function e(){this.global=new i((-1e5),(-1e5)),this.target=null,this.originalEvent=null,this.cancleBubble=!1,this.ratio=1,this.type=""}function s(){this.listeners={}}function n(t){return Object.prototype.toString.call(t)}function o(t){this.element=t.element||{},this.duration=t.duration||300,this.living=!0,this.onCompelete=t.onCompelete||null,this.onUpdate=t.onUpdate||null,this.infinity=t.infinity||!1,this.alternate=t.alternate||!1,this.ease=t.ease||"easeBoth",this.repeats=t.repeats||0,this.delay=t.delay||0,this.wait=t.wait||0,this.delayCut=this.delay,this.progress=0,this.direction=1,this.timeScale=t.timeScale||1,this.totalTime=0,this.paused=!1}function r(t){o.call(this,t),this.from=t.from,this.to=t.to}function h(){}function a(t){o.call(this,t),t.path&&t.path instanceof h||console.warn("%c JC.PathMotion warn %c: path is not instanceof Curve","color: #f98165; background: #80a89e","color: #80a89e; background: #cad9d5;"),this.path=t.path,this.attachTangent=t.attachTangent||!1,this._cacheRotate=this.element.rotation;var e=this._cacheRotate*I.DTR;this._cacheVector=new i(10*Math.cos(e),10*Math.sin(e))}function c(t){o.call(this,t),this._keyframes=t.keys,this._keyIndex=0,this._cursor=1,this._keyConfig=t.keyConfig,this.configKey()}function u(t){this.element=t,this.animates=[]}function p(t,i){s.call(this),this.texture=null,this.width=0,this.height=0,this.naturalWidth=0,this.naturalHeight=0,this.loaded=!1,this.hadload=!1,this.src=t,this.resole(t),i&&I.isString(t)||this.load(t)}function l(){s.call(this),this.textures={},this._total=0,this._failed=0,this._received=0}function d(t,i,e,s){this.x=t||0,this.y=i||0,this.width=e||0,this.height=s||0}function f(t,i,e,s){this.minX=t||1/0,this.minY=i||1/0,this.maxX=e||-(1/0),this.maxY=s||-(1/0),this.rect=null}function y(t){var e=t;if(!I.isArray(e)){e=new Array(arguments.length);for(var s=0;s<e.length;++s)e[s]=arguments[s]}if(e[0]instanceof i){for(var n=[],o=0,r=e.length;o<r;o++)n.push(e[o].x,e[o].y);e=n}this.closed=!0,this.points=e}function v(t,i,e){this.x=t||0,this.y=i||0,this.radius=e||0}function m(t,i,e,s){this.x=t||0,this.y=i||0,this.width=e||0,this.height=s||0}function g(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}function x(t){this.points=t}function w(t){I.isString(t)?this.path=this.createPath(t):"path"===t.nodeName&&t.getAttribute("d")?this.path=t:console.warn('%c JC.SvgCurve warn %c: SvgCurve just accept <path d="M10 10"> element or "M10 10" string but found %c'+t+"%c","color: #f98165; background: #80a89e","color: #80a89e; background: #cad9d5;","color: #f98165; background: #cad9d5","color: #80a89e; background: #cad9d5"),this.totalLength=this.path.getTotalLength()}function b(t,i,e){this.degree=t,this.knots=i,this.controlPoints=e}function _(){s.call(this),this._ready=!0,this.visible=!0,this.worldAlpha=1,this.alpha=1,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.rotation=0,this.rotationCache=0,this._sr=0,this._cr=1,this.x=0,this.y=0,this.pivotX=0,this.pivotY=0,this.mask=null,this.parent=null,this.worldTransform=new g,this.passEvent=!1,this.eventArea=null,this.Animation=new u(this),this._touchstarted=!1,this._mousedowned=!1,this.buttonMode=!1,this.cursor="pointer"}function M(){_.call(this),this.childs=[],this.timeScale=1,this.paused=!1,this._zIndex=0,this.souldSort=!1,this.bounds=new f,this._bounds=new f,this.vertexData=new Float32Array(8)}function T(t,i){this.element=t,this.living=!1,this.onCompelete=null,this.infinity=!1,this.alternate=!1,this.repeats=0,this.animations=i.animations||{},this.index=0,this.preIndex=-1,this.direction=1,this.frames=[],this.preFrame=null,this.fillMode=0,this.fps=16,this.paused=!1,this.pt=0,this.nt=0}function S(t){if(M.call(this),this.texture=t.texture,this.texture.loaded)this.upTexture(t);else{var i=this;this._ready=!1,this.texture.on("load",function(){i.upTexture(t),i._ready=!0})}this.MovieClip=new T(this,t)}function C(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}function k(){M.call(this),this.frameBuffer=null}function P(t,i,e){M.call(this),this.text=t.toString(),this.font=i||"bold 12px Arial",this.color=e||"#000000",this.textAlign="center",this.textBaseline="middle",this.outline=0,this.lineWidth=1,this.US=!1,this.UF=!0}function B(t,i,e){M.call(this),(isNaN(t)||t<0)&&(t=0),(isNaN(i)||i<0)&&(i=0),(isNaN(e)||e<1)&&(e=1),this.frameBuffer=new C,this.blurX=0|t,this.blurY=0|i,this.quality=0|e,this.needUpdateBuffer=!0,this.autoUpdateBuffer=!1,this.padding=!1}function A(t){s.call(this),this.stage=t,this.canvas=this.stage.canvas,this.autoPreventDefault=!0,this.strictMode=!1,this.onMouseUp=this.onMouseUp.bind(this),this.processMouseUp=this.processMouseUp.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.processMouseMove=this.processMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.processMouseDown=this.processMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.processClick=this.processClick.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.processTouchStart=this.processTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.processTouchEnd=this.processTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.processTouchMove=this.processTouchMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.processMouseOverOut=this.processMouseOverOut.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.defaultCursorStyle="inherit",this.currentCursorStyle="inherit"}function O(t){t=t||{},M.call(this),this.canvas=I.isString(t.dom)?document.getElementById(t.dom):t.dom,this.realWidth=t.width||this.canvas.width,this.realHeight=t.height||this.canvas.height,this.ctx=this.canvas.getContext("2d"),this.canvas.style.backgroundColor=t.bgColor||"transparent",this.autoClear=!0,this.autoUpdate=!0,this.autoStyle=!1,this.width=this.canvas.width=this.realWidth*this.resolution,this.height=this.canvas.height=this.realHeight*this.resolution,this._resolution=0,this.resolution=t.resolution||1,this.pt=null,this.snippet=0,this.averageSnippet=0,this.fps=0,this.averageFps=0,this._takeTime=0,this._renderTimes=0,this.enableFPS=!0,this.interactionManager=new A(this),this._interactive=!1,this.interactiveOnChange=function(){this.interactive?this.interactionManager.addEvents():this.interactionManager.removeEvents()},this.interactive=!0,this.proxyOn()}!function(){for(var t=0,i=["ms","moz","webkit","o"],e=0;e<i.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[i[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[e]+"CancelAnimationFrame"]||window[i[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i){var e=(new Date).getTime(),s=Math.max(0,16-(e-t)),n=window.setTimeout(function(){i(e+s)},s);return t=e+s,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)}),window.RAF=window.requestAnimationFrame,window.CAF=window.cancelAnimationFrame}(),i.prototype.clone=function(){return new i(this.x,this.y,this.z,this.w)},i.prototype.copy=function(t){this.set(t.x,t.y,t.z,t.w)},i.prototype.set=function(t,i,e,s){return this.x=t,this.y=i,this.z=e,this.w=s,this},i.prototype.add=function(t,i){return void 0!==i?(console.warn("JC.Point: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},i.prototype.addVectors=function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},i.prototype.sub=function(t,i){return void 0!==i?(console.warn("JC.Point: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},i.prototype.subVectors=function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},i.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},i.prototype.length=function(){return Math.sqrt(this.lengthSq())},i.prototype.normalize=function(){return this.divideScalar(this.length())},i.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},i.prototype.multiplyScalar=function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x=0,this.y=0,this.z=0,this.w=0),this},e.prototype.clone=function(){var t=new e;if(t.originalEvent=this.originalEvent,t.ratio=this.ratio,this.touches){if(t.touches=[],this.touches.length>0){for(var i=0;i<this.touches.length;i++)t.touches[i]={},t.touches[i].global=this.touches[i].global.clone();t.global=t.touches[0].global}}else t.global=this.global.clone();return t},s.prototype.on=function(t,i){this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(i)},s.prototype.off=function(t,i){var e=this.listeners,s=e[t],n=e[t].length;if(s&&n>0)if(i)for(;n--;)s[n]===i&&s.splice(n,1);else s.length=0},s.prototype.once=function(t,i){var e=this,s=function(n){i&&i(n),e.off(t,s)};this.on(t,s)},s.prototype.emit=function(t,i){if(void 0!==this.listeners){var e=this.listeners,s=e[t];if(void 0!==s){var n,o=s.length;for(n=0;n<o;n++)s[n].call(this,i)}}};var E={linear:function(t,i,e,s){return e*t/s+i},easeIn:function(t,i,e,s){return e*(t/=s)*t+i},easeOut:function(t,i,e,s){return-e*(t/=s)*(t-2)+i},easeBoth:function(t,i,e,s){return(t/=s/2)<1?e/2*t*t+i:-e/2*(--t*(t-2)-1)+i},extend:function(t){if(t)for(var i in t)"extend"!==i&&t[i]&&(this[i]=t[i])}},I={copyJSON:function(t){return JSON.parse(JSON.stringify(t))},DTR:Math.PI/180,RTD:180/Math.PI,isArray:function(){var t=n([]);return function(i){return n(i)===t}}(),isObject:function(){var t=n({});return function(i){return n(i)===t}}(),isString:function(){var t=n("s");return function(i){return n(i)===t}}(),isNumber:function(){var t=n(1);return function(i){return n(i)===t}}(),isFunction:function(){var t=n(function(){});return function(i){return n(i)===t}}(),random:function(t,i){return this.isArray(t)?t[~~(Math.random()*t.length)]:(this.isNumber(i)||(i=t||1,t=0),t+Math.random()*(i-t))},euclideanModulo:function(t,i){return(t%i+i)%i},clamp:function(t,i,e){return t<i?i:t>e?e:t}};o.prototype._swapEase=function(){var t=this.ease;t.indexOf("In")>0?t=t.replace("In","Out"):t.indexOf("Out")>0&&(t=t.replace("Out","In")),this.ease=t},o.prototype.update=function(t){if(this.wait>0)return void(this.wait-=Math.abs(t));if(this.paused||!this.living||this.delayCut>0)return void(this.delayCut>0&&(this.delayCut-=Math.abs(t)));var i=this.direction*this.timeScale*t;this.progress=I.clamp(this.progress+i,0,this.duration),this.totalTime+=Math.abs(i);var e=this.nextPose();this.onUpdate&&this.onUpdate(e,this.progress/this.duration),this.totalTime>=this.duration&&(this.repeats>0||this.infinity?(this.repeats>0&&--this.repeats,this.delayCut=this.delay,this.totalTime=0,this.alternate?(this.direction*=-1,this._swapEase()):(this.direction=1,this.progress=0)):(this.living=!1,this.onCompelete&&this.onCompelete(e)))},o.prototype.nextPose=function(){var t={};for(var i in this.to)t[i]=E[this.ease](this.progress,this.from[i],this.to[i]-this.from[i],this.duration),void 0!==this.element[i]&&(this.element[i]=t[i]);return t},o.prototype.pause=function(){this.paused=!0},o.prototype.start=function(){this.paused=!1},o.prototype.stop=function(){this.progress=this.duration},o.prototype.cancle=function(){this.living=!1},r.prototype=Object.create(o.prototype),h.prototype={constructor:h,getPoint:function(t){return console.warn("Curve: Warning, getPoint() not implemented!",t),null},getPointAt:function(t){var i=this.getUtoTmapping(t);return this.getPoint(i)},getPoints:function(t){isNaN(t)&&(t=5);for(var i=[],e=0;e<=t;e++)i.push(this.getPoint(e/t));return i},getSpacedPoints:function(t){isNaN(t)&&(t=5);for(var i=[],e=0;e<=t;e++)i.push(this.getPointAt(e/t));return i},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(isNaN(t)&&(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i,e,s=[],n=this.getPoint(0),o=0;for(s.push(0),e=1;e<=t;e++)i=this.getPoint(e/t),o+=i.distanceTo(n),s.push(o),n=i;return this.cacheArcLengths=s,s},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,i){var e,s,n=this.getLengths(),o=0,r=n.length;s=i?i:t*n[r-1];for(var h,a=0,c=r-1;a<=c;)if(o=Math.floor(a+(c-a)/2),h=n[o]-s,h<0)a=o+1;else{if(!(h>0)){c=o;break}c=o-1}if(o=c,n[o]===s)return e=o/(r-1);var u=n[o],p=n[o+1],l=p-u,d=(s-u)/l;return e=(o+d)/(r-1)},getTangent:function(t){var i=1e-4,e=t-i,s=t+i,n=this.getPoint(e),o=this.getPoint(s),r=o.clone().sub(n);return r.normalize()},getTangentAt:function(t){var i=this.getUtoTmapping(t);return this.getTangent(i)}},a.prototype=Object.create(o.prototype),a.prototype.nextPose=function(){var t=0,i=E[this.ease](this.progress,0,1,this.duration),e=this.path.getPoint(i),s=e.clone();return this.attachTangent&&(t=this.decomposeRotate(i),s.rotation=t===!1?this.preDegree:t,s.rotation+=this._cacheRotate,t!==!1&&(this.preDegree=t)),this.element.setProps(s),s},a.prototype.decomposeRotate=function(t){var i=this.path.getTangent(t),e=this._cacheVector.x*i.y-i.x*this._cacheVector.y,s=e>0?1:-1,n=(i.x*this._cacheVector.x+i.y*this._cacheVector.y)/(Math.sqrt(i.x*i.x+i.y*i.y)*Math.sqrt(this._cacheVector.x*this._cacheVector.x+this._cacheVector.y*this._cacheVector.y));return!isNaN(n)&&s*Math.acos(n)*I.RTD},c.prototype=Object.create(o.prototype),c.prototype.configKey=function(){this.from=this._keyframes[this._keyIndex],this._keyIndex+=this._cursor,this.to=this._keyframes[this._keyIndex];var t=this._keyConfig[Math.min(this._keyIndex,this._keyIndex-this._cursor)]||{};this.ease=t.ease||this.ease,this.duration=t.duration||this.duration,this.progress=0},c.prototype.update=function(t){if(this.wait>0)return void(this.wait-=Math.abs(t));if(this.paused||!this.living||this.delayCut>0)return void(this.delayCut>0&&(this.delayCut-=Math.abs(t)));var i=this.direction*this.timeScale*t;this.progress=I.clamp(this.progress+i,0,this.duration),this.totalTime+=Math.abs(i);var e=this.nextPose();this.onUpdate&&this.onUpdate(e,this.progress/this.duration,this._keyIndex),this.totalTime>=this.duration&&(this.totalTime=0,this._keyIndex<this._keyframes.length-1&&this._keyIndex>0?this.configKey():this.repeats>0||this.infinity?(this.repeats>0&&--this.repeats,this.delayCut=this.delay,this.alternate?this._cursor*=-1:(this._cursor=1,this._keyIndex=0),this.configKey()):(this.living=!1,this.onCompelete&&this.onCompelete()))},u.prototype.update=function(t){for(var i=0;i<this.animates.length;i++)this.animates[i].living||this.animates.splice(i,1),this.animates[i]&&this.animates[i].update(t)},u.prototype.fromTo=function(t,i){return this.element.setProps(t.from),t.element=this.element,this._addMove(new r(t),i)},u.prototype.to=function(t,i){t.from={};for(var e in t.to)t.from[e]=this.element[e];return t.element=this.element,this._addMove(new r(t),i)},u.prototype.motion=function(t,i){return t.element=this.element,this._addMove(new a(t),i)},u.prototype.keyFrames=function(t,i){return t.element=this.element,this._addMove(new c(t),i)},u.prototype._addMove=function(t,i){return i&&this.clear(),this.animates.push(t),t},u.prototype.clear=function(){this.animates.length=0},p.prototype=Object.create(s.prototype),p.prototype.resole=function(t){I.isString(t)&&(this.texture=new Image),(t instanceof Image||"IMG"===t.nodeName)&&(this.texture=t)},p.prototype.load=function(t){if(!this.hadload){var i=this;this.hadload=!0,t=t||this.src,I.isString(t)&&(this.texture.crossOrigin="",this.texture.src=t,this.texture.onload=function(){i.loaded=!0,i.emit("load")},this.texture.onerror=function(){i.emit("error")},this.on("load",function(){i.width=i.texture.width,i.height=i.texture.height,i.naturalWidth=i.texture.naturalWidth,i.naturalHeight=i.texture.naturalHeight})),(t instanceof Image||"IMG"===t.nodeName)&&t.naturalWidth*t.naturalHeight>0&&(this.width=t.width,this.height=t.height,this.naturalWidth=t.naturalWidth,this.naturalHeight=t.naturalHeight)}},l.prototype=Object.create(s.prototype),l.prototype.load=function(t){function i(t){t.on("load",function(){e._received++,e.emit("update"),e._received+e._failed>=e._total&&e.emit("compelete")}),t.on("error",function(){e._failed++,e.emit("update"),e._received+e._failed>=e._total&&e.emit("compelete")})}var e=this;this._total=0,this._failed=0,this._received=0;for(var s in t)this._total++,this.textures[s]=new p(t[s]),i(this.textures[s]);return this},l.prototype.getById=function(t){return this.textures[t]},Object.defineProperty(p.prototype,"progress",{get:function(){return 0===this._total?1:(this._received+this._failed)/this._total}});var X=function(t){return(new l).load(t)};d.EMPTY=new d(0,0,0,0),d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height)},d.prototype.contains=function(t,i){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&i>=this.y&&i<this.y+this.height)},f.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},f.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0)},f.prototype.getRectangle=function(t){return this.isEmpty()?d.EMPTY:(t=t||new d(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},f.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},f.prototype.addRect=function(t){this.minX=t.x,this.maxX=t.width+t.x,this.minY=t.y,this.maxY=t.height+t.y},f.prototype.addVert=function(t){for(var i=this.minX,e=this.minY,s=this.maxX,n=this.maxY,o=0;o<t.length;o+=2){var r=t[o],h=t[o+1];i=r<i?r:i,e=h<e?h:e,s=r>s?r:s,n=h>n?h:n}this.minX=i,this.minY=e,this.maxX=s,this.maxY=n},f.prototype.addBounds=function(t){var i=this.minX,e=this.minY,s=this.maxX,n=this.maxY;this.minX=t.minX<i?t.minX:i,this.minY=t.minY<e?t.minY:e,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>n?t.maxY:n},y.prototype.clone=function(){return new y(this.points.slice())},y.prototype.contains=function(t,i){for(var e=!1,s=this.points.length/2,n=0,o=s-1;n<s;o=n++){var r=this.points[2*n],h=this.points[2*n+1],a=this.points[2*o],c=this.points[2*o+1],u=h>i!=c>i&&t<(a-r)*(i-h)/(c-h)+r;u&&(e=!e)}return e},v.prototype.clone=function(){return new v(this.x,this.y,this.radius)},v.prototype.contains=function(t,i){if(this.radius<=0)return!1;var e=this.x-t,s=this.y-i,n=this.radius*this.radius;return e*=e,s*=s,e+s<=n},v.prototype.getBounds=function(){return new d(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},m.prototype.clone=function(){return new m(this.x,this.y,this.width,this.height)},m.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;var e=(t-this.x)/this.width,s=(i-this.y)/this.height;return e*=e,s*=s,e+s<=1},m.prototype.getBounds=function(){return new d(this.x-this.width,this.y-this.height,this.width,this.height)},g.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},g.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var i=this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},g.prototype.apply=function(t,i){return i=i||{},i.x=this.a*t.x+this.c*t.y+this.tx,i.y=this.b*t.x+this.d*t.y+this.ty,i},g.prototype.applyInverse=function(t,i){var e=1/(this.a*this.d+this.c*-this.b);return i.x=this.d*e*t.x+-this.c*e*t.y+(this.ty*this.c-this.tx*this.d)*e,i.y=this.a*e*t.y+-this.b*e*t.x+(-this.ty*this.a+this.tx*this.b)*e,i},g.prototype.translate=function(t,i){return this.tx+=t,this.ty+=i,this},g.prototype.scale=function(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this},g.prototype.rotate=function(t){var i=Math.cos(t),e=Math.sin(t),s=this.a,n=this.c,o=this.tx;return this.a=s*i-this.b*e,this.b=s*e+this.b*i,this.c=n*i-this.d*e,this.d=n*e+this.d*i,this.tx=o*i-this.ty*e,this.ty=o*e+this.ty*i,this},g.prototype.append=function(t){var i=this.a,e=this.b,s=this.c,n=this.d;return this.a=t.a*i+t.b*s,this.b=t.a*e+t.b*n,this.c=t.c*i+t.d*s,this.d=t.c*e+t.d*n,this.tx=t.tx*i+t.ty*s+this.tx,this.ty=t.tx*e+t.ty*n+this.ty,this},g.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},g.prototype.setTransform=function(t,i,e,s,n,o,r,h,a){var c,u,p,l,d,f,y,v;return d=Math.sin(r),f=Math.cos(r),y=Math.tan(a),v=Math.tan(h),c=f*n,u=d*n,p=-d*o,l=f*o,this.a=c+y*p,this.b=u+y*l,this.c=v*c+p,this.d=v*u+l,this.tx=t+(e*c+s*p),this.ty=i+(e*u+s*l),this};var Y=new g,D=new g;x.prototype=Object.create(h.prototype),x.prototype.getPoint=function(t,e){var s=e||this.points,n=s.length,o=1-t,r=s.slice(0,n-1),h=s.slice(1),a=new i;if(n>3){var c=this.getPoint(t,r),u=this.getPoint(t,h);return a.x=o*c.x+t*u.x,a.y=o*c.y+t*u.y,a}return a.x=o*o*e[0].x+2*t*o*e[1].x+t*t*e[2].x,a.y=o*o*e[0].y+2*t*o*e[1].y+t*t*e[2].y,a},w.prototype=Object.create(h.prototype),w.prototype.createPath=function(t){var i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute(t)},w.prototype.getPoint=function(t){var e=this.path.getPointAtLength(t*this.totalLength);return new i(e.x,e.y)};var z={findSpan:function(t,i,e){var s=e.length-t-1;if(i>=e[s])return s-1;if(i<=e[t])return t;for(var n=t,o=s,r=Math.floor((n+o)/2);i<e[r]||i>=e[r+1];)i<e[r]?o=r:n=r,r=Math.floor((n+o)/2);return r},calcBasisFunctions:function(t,i,e,s){var n=[],o=[],r=[];n[0]=1;for(var h=1;h<=e;++h){o[h]=i-s[t+1-h],r[h]=s[t+h]-i;for(var a=0,c=0;c<h;++c){var u=r[c+1],p=o[h-c],l=n[c]/(u+p);n[c]=a+u*l,a=p*l}n[h]=a}return n},calcBSplinePoint:function(t,e,s,n){for(var o=this.findSpan(t,n,e),r=this.calcBasisFunctions(o,n,t,e),h=new i(0,0,0,0),a=0;a<=t;++a){var c=s[o-t+a],u=r[a],p=c.w*u;h.x+=c.x*p,h.y+=c.y*p,h.z+=c.z*p,h.w+=c.w*u}return h},calcBasisFunctionDerivatives:function(t,i,e,s,n){for(var o=[],r=0;r<=e;++r)o[r]=0;var h=[];for(r=0;r<=s;++r)h[r]=o.slice(0);var a=[];for(r=0;r<=e;++r)a[r]=o.slice(0);a[0][0]=1;for(var c=o.slice(0),u=o.slice(0),p=1;p<=e;++p){c[p]=i-n[t+1-p],u[p]=n[t+p]-i;for(var l=0,d=0;d<p;++d){var f=u[d+1],y=c[p-d];a[p][d]=f+y;var v=a[d][p-1]/a[p][d];a[d][p]=l+f*v,l=y*v}a[p][p]=l}for(p=0;p<=e;++p)h[0][p]=a[p][e];for(d=0;d<=e;++d){var m=0,g=1,x=[];for(r=0;r<=e;++r)x[r]=o.slice(0);x[0][0]=1;for(var w=1;w<=s;++w){var b=0,_=d-w,M=e-w;d>=w&&(x[g][0]=x[m][0]/a[M+1][_],b=x[g][0]*a[_][M]);var T=_>=-1?1:-_,S=d-1<=M?w-1:e-d;for(p=T;p<=S;++p)x[g][p]=(x[m][p]-x[m][p-1])/a[M+1][_+p],b+=x[g][p]*a[_+p][M];d<=M&&(x[g][w]=-x[m][w-1]/a[M+1][d],b+=x[g][w]*a[d][M]),h[w][d]=b,p=m,m=g,g=p}}for(d=e,w=1;w<=s;++w){for(p=0;p<=e;++p)h[w][p]*=d;d*=e-w}return h},calcBSplineDerivatives:function(t,e,s,n,o){for(var r,h=o<t?o:t,a=[],c=this.findSpan(t,n,e),u=this.calcBasisFunctionDerivatives(c,n,t,h,e),p=[],l=0;l<s.length;++l){r=s[l].clone();var d=r.w;r.x*=d,r.y*=d,r.z*=d,p[l]=r}for(var f=0;f<=h;++f){r=p[c-t].clone().multiplyScalar(u[f][0]);for(var y=1;y<=t;++y)r.add(p[c-t+y].clone().multiplyScalar(u[f][y]));a[f]=r}for(f=h+1;f<=o+1;++f)a[f]=new i(0,0,0);return a},calcKoverI:function(t,i){for(var e=1,s=2;s<=t;++s)e*=s;var n=1;for(s=2;s<=i;++s)n*=s;for(s=2;s<=t-i;++s)n*=s;return e/n},calcRationalCurveDerivatives:function(t){for(var e=t.length,s=[],n=[],o=0;o<e;++o){var r=t[o];s[o]=new i(r.x,r.y,r.z),n[o]=r.w}for(var h=[],a=0;a<e;++a){var c=s[a].clone();for(o=1;o<=a;++o)c.sub(h[a-o].clone().multiplyScalar(this.calcKoverI(a,o)*n[o]));h[a]=c.divideScalar(n[0])}return h},calcNURBSDerivatives:function(t,i,e,s,n){var o=this.calcBSplineDerivatives(t,i,e,s,n);return this.calcRationalCurveDerivatives(o)},calcSurfacePoint:function(t,e,s,n,o,r,h){for(var a=this.findSpan(t,r,s),c=this.findSpan(e,h,n),u=this.calcBasisFunctions(a,r,t,s),p=this.calcBasisFunctions(c,h,e,n),l=[],d=0;d<=e;++d){l[d]=new i(0,0,0,0);for(var f=0;f<=t;++f){var y=o[a-t+f][c-e+d].clone(),v=y.w;y.x*=v,y.y*=v,y.z*=v,l[d].add(y.multiplyScalar(u[f]))}}var m=new i(0,0,0,0);for(d=0;d<=e;++d)m.add(l[d].multiplyScalar(p[d]));return m.divideScalar(m.w),new i(m.x,m.y,m.z)}};b.prototype=Object.create(h.prototype),b.prototype.constructor=b,b.prototype.getPoint=function(t){var e=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),s=z.calcBSplinePoint(this.degree,this.knots,this.controlPoints,e);return 1!==s.w&&s.divideScalar(s.w),new i(s.x,s.y,s.z)},b.prototype.getTangent=function(t){var i=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),e=z.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,i,1),s=e[1].clone();return s.normalize(),s},_.prototype=Object.create(s.prototype),Object.defineProperty(_.prototype,"scale",{get:function(){return this.scaleX},set:function(t){this.scaleX=this.scaleY=t}}),_.prototype.fromTo=function(t,i){return this.Animation.fromTo(t,i)},_.prototype.to=function(t,i){return this.Animation.to(t,i)},_.prototype.motion=function(t,i){return this.Animation.motion(t,i)},_.prototype.keyFrames=function(t,i){return this.Animation.keyFrames(t,i)},_.prototype.isVisible=function(){return!!(this.visible&&this.alpha>0&&this.scaleX*this.scaleY!==0)},_.prototype.removeMask=function(){this.mask=null},_.prototype.setProps=function(t){if(void 0!==t)for(var i in t)void 0!==this[i]&&(this[i]=t[i])},_.prototype.updateTransform=function(){var t,i,e,s,n,o,r=this.parent.worldTransform,h=this.worldTransform;this.skewX||this.skewY?(D.setTransform(this.x,this.y,this.pivotX,this.pivotY,this.scaleX,this.scaleY,this.rotation*I.DTR,this.skewX*I.DTR,this.skewY*I.DTR),h.a=D.a*r.a+D.b*r.c,h.b=D.a*r.b+D.b*r.d,h.c=D.c*r.a+D.d*r.c,h.d=D.c*r.b+D.d*r.d,h.tx=D.tx*r.a+D.ty*r.c+r.tx,h.ty=D.tx*r.b+D.ty*r.d+r.ty):this.rotation%360?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation*I.DTR),this._cr=Math.cos(this.rotation*I.DTR)),t=this._cr*this.scaleX,i=this._sr*this.scaleX,e=-this._sr*this.scaleY,s=this._cr*this.scaleY,n=this.x,o=this.y,(this.pivotX||this.pivotY)&&(n-=this.pivotX*t+this.pivotY*e,o-=this.pivotX*i+this.pivotY*s),h.a=t*r.a+i*r.c,h.b=t*r.b+i*r.d,h.c=e*r.a+s*r.c,h.d=e*r.b+s*r.d,h.tx=n*r.a+o*r.c+r.tx,h.ty=n*r.b+o*r.d+r.ty):(t=this.scaleX,s=this.scaleY,n=this.x-this.pivotX*t,o=this.y-this.pivotY*s,h.a=t*r.a,h.b=t*r.b,h.c=s*r.c,h.d=s*r.d,h.tx=n*r.a+o*r.c+r.tx,h.ty=n*r.b+o*r.d+r.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha},_.prototype.updateAnimation=function(t){this.Animation.update(t)},_.prototype.setTransform=function(t){var i=this.worldTransform;t.globalAlpha=this.worldAlpha,t.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty)},_.prototype.getGlobalPos=function(){return{x:this.worldTransform.tx,y:this.worldTransform.ty}},_.prototype.setArea=function(t,i){null!==this.eventArea&&i||(this.eventArea=t)},_.prototype.contains=function(t){if(null===this.eventArea)return!1;var e=new i;return this.worldTransform.applyInverse(t,e),this.eventArea&&this.eventArea.contains(e.x,e.y)},M.prototype=Object.create(_.prototype),Object.defineProperty(M.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex!==t&&(this._zIndex=t,this.parent&&(this.parent.souldSort=!0))}}),M.prototype._sortList=function(){this.childs.sort(function(t,i){return t.zIndex>i.zIndex?1:t.zIndex<i.zIndex?-1:0}),this.souldSort=!1},M.prototype.adds=function(t){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.adds(arguments[i]);return this}return t===this?(console.error("adds: object can't be added as a child of itself.",t),this):(t&&t instanceof M?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.childs.push(t),this.souldSort=!0):console.error("adds: object not an instance of Container",t),this)},M.prototype.remove=function(t){if(arguments.length>1)for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);var e=this.childs.indexOf(t);e!==-1&&(t.parent=null,this.childs.splice(e,1))},M.prototype.updatePosture=function(t){if(this._ready){this.souldSort&&this._sortList(),t=this.timeScale*t,this.paused||this.updateAnimation(t),this.updateTransform();for(var i=0,e=this.childs.length;i<e;i++){var s=this.childs[i];s.updatePosture(t)}}},M.prototype.render=function(t){t.save(),this.setTransform(t),this.mask&&this.mask.render(t),this.renderMe(t);for(var i=0,e=this.childs.length;i<e;i++){var s=this.childs[i];s.isVisible()&&s._ready&&s.render(t)}t.restore()},M.prototype.renderMe=function(){return!0},M.prototype.calculateVertices=function(){var t,i,e,s,n=this.worldTransform,o=n.a,r=n.b,h=n.c,a=n.d,c=n.tx,u=n.ty,p=this.vertexData;t=this._bounds.minX,i=this._bounds.maxX,e=this._bounds.minY,s=this._bounds.maxY,p[0]=o*i+h*s+c,p[1]=a*s+r*i+u,p[2]=o*t+h*s+c,p[3]=a*s+r*t+u,p[4]=o*t+h*e+c,p[5]=a*e+r*t+u,p[6]=o*i+h*e+c,p[7]=a*e+r*i+u},M.prototype.calculateBounds=function(){if(this.bounds.clear(),this.visible){this._calculateBounds();for(var t=0;t<this.childs.length;t++){var i=this.childs[t];i.calculateBounds(),this.bounds.addBounds(i.bounds)}}},M.prototype._calculateBounds=function(){this.calculateVertices(),this.bounds.addVert(this.vertexData)},M.prototype.setBounds=function(t){t instanceof f&&(this._bounds=t)},M.prototype.pause=function(){this.paused=!0},M.prototype.start=function(){this.paused=!1},M.prototype.cancle=function(){this.Animator.clear()},T.prototype.update=function(t){if(!this.paused&&this.living&&(this.nt+=t,!(this.nt-this.pt<this.interval))){this.pt=this.nt;var i=this.index+this.direction;i<this.frames.length&&i>=0?this.index=i:this.repeats>0||this.infinity?(this.repeats>0&&--this.repeats,this.alternate?(this.direction*=-1,this.index+=this.direction):(this.direction=1,this.index=0)):(this.living=!1,this.index=this.fillMode,this.onCompelete&&this.onCompelete(),this.next&&this.next())}},T.prototype.getFrame=function(){if(this.index===this.preIndex&&null!==this.preFrame)return this.preFrame;var t=this.element.frame.clone(),i=this.frames[this.index];if(i>0){var e=this.element.naturalWidth/this.element.frame.width>>0,s=this.element.frame.x/this.element.frame.width>>0,n=(s+i)/e>>0,o=(s+i)%e;t.x=o*this.element.frame.width,t.y+=n*this.element.frame.height}return this.preIndex=this.index,this.preFrame=t,t},T.prototype.playMovie=function(t){this.next=null;var i=this.format(t.movie);I.isArray(i)&&(this.frames=i,this.index=0,this.direction=1,this.fillMode=t.fillMode||0,this.fps=t.fps||this.fps,this.infinity=t.infinity||!1,this.alternate=t.alternate||!1,this.repeats=t.repeats||0,this.living=!0,this.onCompelete=t.onCompelete||null)},T.prototype.format=function(t){if(I.isString(t)){var i=this.animations[t];return i?this.format(i):(console.warn("%c JC.MovieClip warn %c: you didn`t config %c"+t+"%c in animations ","color: #f98165; background: #80a89e","color: #80a89e; background: #cad9d5;","color: #f98165; background: #cad9d5","color: #80a89e; background: #cad9d5"),!1)}if(I.isArray(t))return t;if(I.isObject(t)){for(var e=[],s=t.start;s<=t.end;s++)e.push(s);if(t.next&&this.animations[t.next]){var n=this,o={};I.isString(t.next)&&this.animations[t.next]?(o.movie=t.next,o.infinity=!0):I.isObject(t.next)&&(o=t.next),I.isString(o.movie)&&(this.next=function(){n.playMovie(o)})}return e}},T.prototype.pause=function(){this.paused=!0},T.prototype.start=function(){this.paused=!1},T.prototype.cancle=function(){this.living=!1},Object.defineProperty(T.prototype,"interval",{get:function(){return this.fps>0?1e3/this.fps>>0:16}}),S.prototype=Object.create(M.prototype),S.prototype.upTexture=function(t){this.naturalWidth=t.texture.naturalWidth,this.naturalHeight=t.texture.naturalHeight,this.frame=t.frame||new d(0,0,this.naturalWidth,this.naturalHeight),this.width=t.width||this.frame.width||this.naturalWidth,this.height=t.height||this.frame.height||this.naturalHeight,this.regX=this.width>>1,
this.regY=this.height>>1;var i=new d((-this.regX),(-this.regY),this.width,this.height);this._bounds.addRect(i),this.setArea(i,!0)},S.prototype.updateAnimation=function(t){this.Animation.update(t),this.MovieClip.update(t)},S.prototype.playMovie=function(t){this.MovieClip.playMovie(t)},S.prototype.renderMe=function(t){if(this._ready){var i=this.MovieClip.getFrame();t.drawImage(this.texture.texture,i.x,i.y,i.width,i.height,-this.regX,-this.regY,this.width,this.height)}},C.prototype.setSize=function(t){this.width=this.canvas.width=t.width+2*t.px,this.height=this.canvas.height=t.height+2*t.py},C.prototype.clear=function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.width,this.height)},C.prototype.setTransform=function(t,i,e,s,n,o){this.ctx.setTransform(t,i,e,s,n,o)},C.prototype.getBuffer=function(){return this.bufferData=this.ctx.getImageData(0,0,this.width,this.height),this.bufferData},C.prototype.putBuffer=function(){return this.ctx.putImageData(this.bufferData,0,0),this.canvas},C.prototype.createBuffer=function(){},k.prototype=Object.create(M.prototype),k.prototype.renderMe=function(t){this.draw&&(this.cached||this.cache?(this.cache&&(null===this.frameBuffer&&(this.frameBuffer=new C),this.frameBuffer.clear(),this.__co=this._bounds.getRectangle(),this.__co.px=this.__co.py=0,this.frameBuffer.setSize(this.__co),this.frameBuffer.setTransform(1,0,0,1,-this.__co.x,-this.__co.y),this._drawBack(this.frameBuffer.ctx),this.cached=!0,this.cache=!1),this.frameBuffer&&t.drawImage(this.frameBuffer.canvas,this.__co.x-this.__co.px,this.__co.y-this.__co.py,this.frameBuffer.width,this.frameBuffer.height)):this._drawBack(t))},k.prototype._drawBack=function(t){"function"==typeof this.draw?this.draw(t):"object"==typeof this.draw&&"function"==typeof this.draw.render&&this.draw.render(t)},k.prototype.drawCall=function(t,i){void 0!==t&&(i=i||{},this.cache=i.cache||!1,this.cached=!1,this.draw=t||null,this.setBounds(i.bounds))},P.prototype=Object.create(M.prototype),P.prototype.renderMe=function(t){t.font=this.font,t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,this.UF&&(t.fillStyle=this.color,t.fillText(this.text,0,0)),this.US&&(t.lineWidth=this.lineWidth,t.strokeStyle=this.color,t.strokeText(this.text,0,0))},B.prototype=Object.create(M.prototype),Object.defineProperty(B.prototype,"blur",{get:function(){return this.blurX},set:function(t){this.blurX=this.blurY=t}}),B.prototype.updatePosture=function(t){this._ready&&(this.souldSort&&this._sortList(),t=this.timeScale*t,this.paused||this.updateAnimation(t),this.updateTransform(),this.needUpdateBuffer||this.autoUpdateBuffer?(this.cacheMatrix=this.worldTransform,this.worldTransform=F.identity(),this._upc(t),this.calculateBounds(),this.__o=this.bounds.getRectangle(),this.__o.px=this.__o.py=0,this.padding&&(this.__o.px=this.blurX,this.__o.py=this.blurY),this.worldTransform.translate(-this.__o.x+this.__o.px,-this.__o.y+this.__o.py),this._upc(0),this.worldTransform=this.cacheMatrix):this._upc(t))},B.prototype._upc=function(t){for(var i=0,e=this.childs.length;i<e;i++){var s=this.childs[i];s.updatePosture(t)}},B.prototype.render=function(t){if(this.needUpdateBuffer||this.autoUpdateBuffer){var i=0,e=this.childs.length,s=null;for(this.frameBuffer.clear(),this.frameBuffer.setSize(this.__o),i=0;i<e;i++)s=this.childs[i],s.isVisible()&&s._ready&&s.render(this.frameBuffer.ctx);this._applyFilter(this.frameBuffer.getBuffer()),this.needUpdateBuffer=!1}this.renderMe(t,this.__o.x-this.__o.px,this.__o.y-this.__o.py,this.frameBuffer.width,this.frameBuffer.height)},B.prototype.renderMe=function(t,i,e,s,n){this.setTransform(t),t.drawImage(this.frameBuffer.putBuffer(),0,0,s,n,i,e,s,n)};var F=new g,L=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],U=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9];B.prototype._applyFilter=function(t){var i=this.blurX>>1;if(isNaN(i)||i<0)return!1;var e=this.blurY>>1;if(isNaN(e)||e<0)return!1;if(0==i&&0==e)return!1;var s=this.quality;(isNaN(s)||s<1)&&(s=1),s|=0,s>3&&(s=3),s<1&&(s=1);var n=t.data,o=0,r=0,h=0,a=0,c=0,u=0,p=0,l=0,d=0,f=0,y=0,v=0,m=0,g=0,x=0,w=i+i+1|0,b=e+e+1|0,_=0|t.width,M=0|t.height,T=_-1|0,S=M-1|0,C=i+1|0,k=e+1|0,P={r:0,b:0,g:0,a:0},B=P;for(h=1;h<w;h++)B=B.n={r:0,b:0,g:0,a:0};B.n=P;var A={r:0,b:0,g:0,a:0},O=A;for(h=1;h<b;h++)O=O.n={r:0,b:0,g:0,a:0};O.n=A;for(var E=null,I=0|L[i],X=0|U[i],Y=0|L[e],D=0|U[e];s-- >0;){p=u=0;var z=I,F=X;for(r=M;--r>-1;){for(l=C*(v=n[0|u]),d=C*(m=n[u+1|0]),f=C*(g=n[u+2|0]),y=C*(x=n[u+3|0]),B=P,h=C;--h>-1;)B.r=v,B.g=m,B.b=g,B.a=x,B=B.n;for(h=1;h<C;h++)a=u+((T<h?T:h)<<2)|0,l+=B.r=n[a],d+=B.g=n[a+1],f+=B.b=n[a+2],y+=B.a=n[a+3],B=B.n;for(E=P,o=0;o<_;o++)n[u++]=l*z>>>F,n[u++]=d*z>>>F,n[u++]=f*z>>>F,n[u++]=y*z>>>F,a=p+((a=o+i+1)<T?a:T)<<2,l-=E.r-(E.r=n[a]),d-=E.g-(E.g=n[a+1]),f-=E.b-(E.b=n[a+2]),y-=E.a-(E.a=n[a+3]),E=E.n;p+=_}for(z=Y,F=D,o=0;o<_;o++){for(u=o<<2|0,l=k*(v=n[u])|0,d=k*(m=n[u+1|0])|0,f=k*(g=n[u+2|0])|0,y=k*(x=n[u+3|0])|0,O=A,h=0;h<k;h++)O.r=v,O.g=m,O.b=g,O.a=x,O=O.n;for(c=_,h=1;h<=e;h++)u=c+o<<2,l+=O.r=n[u],d+=O.g=n[u+1],f+=O.b=n[u+2],y+=O.a=n[u+3],O=O.n,h<S&&(c+=_);if(u=o,E=A,s>0)for(r=0;r<M;r++)a=u<<2,n[a+3]=x=y*z>>>F,x>0?(n[a]=l*z>>>F,n[a+1]=d*z>>>F,n[a+2]=f*z>>>F):n[a]=n[a+1]=n[a+2]=0,a=o+((a=r+k)<S?a:S)*_<<2,l-=E.r-(E.r=n[a]),d-=E.g-(E.g=n[a+1]),f-=E.b-(E.b=n[a+2]),y-=E.a-(E.a=n[a+3]),E=E.n,u+=_;else for(r=0;r<M;r++)a=u<<2,n[a+3]=x=y*z>>>F,x>0?(x=255/x,n[a]=(l*z>>>F)*x,n[a+1]=(d*z>>>F)*x,n[a+2]=(f*z>>>F)*x):n[a]=n[a+1]=n[a+2]=0,a=o+((a=r+k)<S?a:S)*_<<2,l-=E.r-(E.r=n[a]),d-=E.g-(E.g=n[a+1]),f-=E.b-(E.b=n[a+2]),y-=E.a-(E.a=n[a+3]),E=E.n,u+=_}}return!0},A.prototype=Object.create(s.prototype),A.prototype.addEvents=function(){this.canvas&&!this.eventsAdded&&(window.document.addEventListener("mousemove",this.onMouseMove,!0),this.canvas.addEventListener("mousedown",this.onMouseDown,!0),this.canvas.addEventListener("click",this.onClick,!0),this.canvas.addEventListener("mouseout",this.onMouseOut,!0),this.canvas.addEventListener("mouseover",this.onMouseOver,!0),this.canvas.addEventListener("touchstart",this.onTouchStart,!0),this.canvas.addEventListener("touchend",this.onTouchEnd,!0),this.canvas.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!0)},A.prototype.removeEvents=function(){this.canvas&&(window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.canvas.removeEventListener("mousedown",this.onMouseDown,!0),this.canvas.removeEventListener("click",this.onClick,!0),this.canvas.removeEventListener("mouseout",this.onMouseOut,!0),this.canvas.removeEventListener("mouseover",this.onMouseOver,!0),this.canvas.removeEventListener("touchstart",this.onTouchStart,!0),this.canvas.removeEventListener("touchend",this.onTouchEnd,!0),this.canvas.removeEventListener("touchmove",this.onTouchMove,!0),window.removeEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!1)},A.prototype.onMouseMove=function(t){var i=this.fixCoord(t);this.cursor=this.defaultCursorStyle,this.processInteractive(this.stage,i,this.processMouseMove,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.canvas.style.cursor=this.cursor),this.emit("mousemove",i)},A.prototype.processMouseMove=function(t,i,e){this.processMouseOverOut(t,i,e),e&&this.dispatchEvent(t,"mousemove",i)},A.prototype.processMouseOverOut=function(t,i,e){var s=i.clone();e?(t._over||(t._over=!0,this.dispatchEvent(t,"mouseover",s)),t.buttonMode&&(this.cursor=t.cursor)):t._over&&(t._over=!1,this.dispatchEvent(t,"mouseout",s))},A.prototype.onMouseDown=function(t){this.autoPreventDefault&&t.preventDefault();var i=this.fixCoord(t);this.processInteractive(this.stage,i,this.processMouseDown,!0),this.emit("mousedown",i)},A.prototype.processMouseDown=function(t,i,e){e&&this.dispatchEvent(t,i.type,i)},A.prototype.onClick=function(t){this.autoPreventDefault&&t.preventDefault();var i=this.fixCoord(t);this.processInteractive(this.stage,i,this.processClick,!0),this.emit("click",i)},A.prototype.processClick=function(t,i,e){e&&this.dispatchEvent(t,i.type,i)},A.prototype.onMouseUp=function(t){var i=this.fixCoord(t);this.processInteractive(this.stage,i,this.processMouseUp,!0),this.emit("mouseup",i)},A.prototype.processMouseUp=function(t,i,e){e&&this.dispatchEvent(t,i.type,i)},A.prototype.onMouseOut=function(t){var i=this.fixCoord(t);this.processInteractive(this.stage,i,this.processMouseOverOut,!1),this.emit("mouseout",t)},A.prototype.onMouseOver=function(t){this.emit("mouseover",t)},A.prototype.onTouchStart=function(t){var i=this.fixCoord(t);this.processInteractive(this.stage,i,this.processTouchStart,!0),this.emit("touchstart",i)},A.prototype.processTouchStart=function(t,i,e){e&&(t._touchstarted=!0,this.dispatchEvent(t,"touchstart",i))},A.prototype.onTouchEnd=function(t){var i=this.fixCoord(t);this.processInteractive(this.stage,i,this.processTouchEnd,this.strictMode),this.emit("touchend",i)},A.prototype.processTouchEnd=function(t,i){t._touchstarted&&(t._touchstarted=!1,this.dispatchEvent(t,"touchend",i))},A.prototype.onTouchMove=function(t){this.autoPreventDefault&&t.preventDefault();var i=this.fixCoord(t);this.processInteractive(this.stage,i,this.processTouchMove,this.strictMode),this.emit("touchmove",i)},A.prototype.processTouchMove=function(t,i,e){(!this.strictMode&&t._touchstarted||e)&&this.dispatchEvent(t,"touchmove",i)},A.prototype.processInteractive=function(t,i,e,s){function n(t,i,e,s){for(var o=t.childs,r=!1,h=o.length-1;h>=0;){var a=o[h--];r=!1,a.passEvent||(a.childs.length>0&&n(a,i,e,s)&&(s=!1,r=!0),s&&!r&&(r=a.contains(i.global),r&&(i.target=a,s=!1)),e(a,i,r))}return r}n(t,i,e,s)},A.prototype.dispatchEvent=function(t,i,e){if(!e.cancleBubble){e.target=t,e.type=i,t.emit(i,e);var s="on"+i;t[s]&&t[s](e)}},A.prototype.fixCoord=function(t){var s=new e,n=this.getPos(this.canvas);if(s.originalEvent=t,s.type=t.type,s.ratio=this.canvas.width/this.canvas.offsetWidth,t.touches){if(s.touches=[],t.touches.length>0){for(var o=0;o<t.touches.length;o++)s.touches[o]={},s.touches[o].global=new i((t.touches[o].pageX-n.x)*s.ratio,(t.touches[o].pageY-n.y)*s.ratio);s.global=s.touches[0].global}}else s.global.x=(t.pageX-n.x)*s.ratio,s.global.y=(t.pageY-n.y)*s.ratio;return s},A.prototype.getPos=function(t){var e=new i;if(t.offsetParent){var s=this.getPos(t.offsetParent);e.x=t.offsetLeft+s.x,e.y=t.offsetTop+s.y}else e.x=t.offsetLeft,e.y=t.offsetTop;return e},O.prototype=Object.create(M.prototype),O.prototype.proxyOn=function(){var t=this;this.interactionManager.on("click",function(i){t.emit("click",i)}),this.interactionManager.on("mousemove",function(i){t.emit("mousemove",i)}),this.interactionManager.on("mousedown",function(i){t.emit("mousedown",i)}),this.interactionManager.on("mouseout",function(i){t.emit("mouseout",i)}),this.interactionManager.on("mouseover",function(i){t.emit("mouseover",i)}),this.interactionManager.on("touchstart",function(i){t.emit("touchstart",i)}),this.interactionManager.on("touchend",function(i){t.emit("touchend",i)}),this.interactionManager.on("touchmove",function(i){t.emit("touchmove",i)}),this.interactionManager.on("mouseup",function(i){t.emit("mouseup",i)})},Object.defineProperty(O.prototype,"interactive",{get:function(){return this._interactive},set:function(t){this._interactive!==t&&(this._interactive=t,this.interactiveOnChange())}}),Object.defineProperty(O.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution!==t&&(this._resolution=t,this.worldTransform.identity().scale(t,t),this.resize())}}),O.prototype.resize=function(t,i,e,s){I.isNumber(t)&&I.isNumber(i)?(this.realWidth=t,this.realHeight=i):(t=this.realWidth,i=this.realHeight),this.width=this.canvas.width=t*this.resolution,this.height=this.canvas.height=i*this.resolution,this.autoStyle&&e&&s&&(this.canvas.style.width=I.isString(e)?e:e+"px",this.canvas.style.height=I.isString(s)?s:s+"px")},O.prototype.render=function(){this.emit("prerender"),this.timeline(),this.autoUpdate&&this.update(),this.ctx.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx,this.worldTransform.ty),this.autoClear&&this.ctx.clearRect(0,0,this.width,this.height);for(var t=0,i=this.childs.length;t<i;t++){var e=this.childs[t];e.isVisible()&&e._ready&&e.render(this.ctx)}this.emit("postrender")},O.prototype.update=function(){this.updatePosture(this.timeScale*this.snippet)},O.prototype.timeline=function(){this.snippet=Date.now()-this.pt,(null===this.pt||this.snippet>200)&&(this.pt=Date.now(),this.snippet=Date.now()-this.pt),this.enableFPS&&(this._renderTimes++,this._takeTime+=Math.max(15,this.snippet),this.fps=1e3/Math.max(15,this.snippet)>>0,this.averageFps=1e3/(this._takeTime/this._renderTimes)>>0),this.pt+=this.snippet},O.prototype.updatePosture=function(t){for(var i=0,e=this.childs.length;i<e;i++){var s=this.childs[i];s.updatePosture(t)}},t.TWEEN=E,t.UTILS=I,t.Texture=p,t.Loader=l,t.loaderUtil=X,t.Bounds=f,t.Point=i,t.Rectangle=d,t.Polygon=y,t.Circle=v,t.Ellipse=m,t.Matrix=g,t.IDENTITY=Y,t.TEMP_MATRIX=D,t.BezierCurve=x,t.SvgCurve=w,t.NURBSCurve=b,t.DisplayObject=_,t.Container=M,t.Sprite=S,t.Graphics=k,t.TextFace=P,t.BlurFilter=B,t.Stage=O,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=jcc2d.min.js.map
